name: CI NetSpy ğŸ•µï¸â€â™‚ï¸

on:
  workflow_dispatch:
  push:
    branches: [ "main" ]
    paths:
      - 'cmd/netspy/**' # Corregido: cmd en lugar de c

jobs:
  build-go:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./cmd/netspy # <--- Â¡AquÃ­ estaba el error!

    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4

    - name: ğŸ¹ Instalar Go
      uses: actions/setup-go@v5
      with:
        go-version: '1.23'

    # Como tu go.mod estÃ¡ en la raiz pero el codigo en cmd/netspy, 
    # a veces Go necesita ayuda. Vamos a probar compilaciÃ³n directa primero.
    - name: ğŸ”¨ Compilar
      run: go build -v .

  build-docker:
    needs: build-go
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: ./cmd/netspy # <--- Corregido tambiÃ©n aquÃ­

    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4

    - name: ğŸ³ Construir Imagen Docker
      run: docker build .
