name: CI NetSpy ğŸ•µï¸â€â™‚ï¸

on:
  # 1. BotÃ³n Manual: Te permite correrlo con un clic desde la web
  workflow_dispatch:
  
  # 2. Push: Corre en cualquier cambio a la rama main (quitamos el filtro de paths por ahora)
  push:
    branches: [ "main" ]

jobs:
  build-go:
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: /cmd/netspy # AsegÃºrate de que esta ruta sea real

    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4

    - name: ğŸ¹ Instalar Go
      uses: actions/setup-go@v5
      with:
        go-version: '1.23'

    - name: â¬‡ï¸ Bajar dependencias
      run: go mod download

    - name: ğŸ”¨ Compilar
      run: go build -v .

  build-docker:
    needs: build-go
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: /cmd/netspy

    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4

    - name: ğŸ³ Construir Imagen Docker
      run: docker build .
