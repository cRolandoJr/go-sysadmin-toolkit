name: CI NetSpy ğŸ•µï¸â€â™‚ï¸

on:
  workflow_dispatch: # BotÃ³n manual
  push:
    branches: [ "main" ]

jobs:
  build-go:
    runs-on: ubuntu-latest
    
    # IMPORTANTE: AsegÃºrate de que esta ruta coincida con TU repo (Â¿es 'c' o 'cmd'?)
    defaults:
      run:
        working-directory: c/netspy 

    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4

    # --- PASO DE DEBUG NUEVO ---
    - name: ğŸ•µï¸â€â™‚ï¸ DEBUG - Listar archivos
      run: |
        echo "Estoy en la ruta: $(pwd)"
        echo "Listando todo el repositorio:"
        ls -R ../.. 
      # Usamos ../.. para subir a la raiz y ver todo el arbol de carpetas
    # ---------------------------

    - name: ğŸ¹ Instalar Go
      uses: actions/setup-go@v5
      with:
        go-version: '1.23'

    - name: â¬‡ï¸ Bajar dependencias
      run: go mod download

    - name: ğŸ”¨ Compilar
      run: go build -v .

  build-docker:
    needs: build-go
    runs-on: ubuntu-latest
    defaults:
      run:
        working-directory: c/netspy

    steps:
    - name: ğŸ“¥ Descargar cÃ³digo
      uses: actions/checkout@v4

    - name: ğŸ³ Construir Imagen Docker
      run: docker build .
